---
title: "4_study1plots"
author: "Jen Richmond"
date: "13/07/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# load packages
 
```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(ggeasy)

```

# read data

```{r message=FALSE, warning=FALSE}
clean_data <- read_csv(here("data", "dateStudy1data_clean.csv"))


summary_data <- read_csv(here("data", "summary_data.csv"))

manipcheck <- read_csv(here("data", "manipcheck.csv"))

per_att_int <- read_csv(here("data", "per_att_int.csv"))

```



Categorical variable: group
Continuous variable: perception_1, mean_att, mean_int

#Mean ratings for gain manipulation check by group

Column graph:

> yup except when you want to match to 1 thing, you use == rather than %in%. If you want to match to any of the items in a list, use %in% c("thingone", "thingtwo"). The group_by here isn't necessary either. You only need that when you want to do a summarise right after. 

```{r}

gainmanip <- manipcheck %>%
  filter(question == "gainmanipulation") 

gainmanip %>%
    ggplot(aes(x = group, y = mean, fill = group)) +
    geom_col(width = 0.5, show.legend = FALSE) +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3, 
                  width=.2) +
  theme_classic() +
  labs(title = "To what extent did the information stress the positive benefits of \nadopting open science practices?", x="Condition", y="Mean ratings of gain manipulation")

```


Geom jitter plot:

```{r}

clean_data <- clean_data %>%
  mutate(group = factor(group, 
                        levels = c(1, 2),
                        labels = c("Gain", "Loss")))

```



```{r}

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = manipulation_check_gf_1, colour = group)) +
  geom_jitter(width = 0.3, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,6)) +
  theme_classic() +
  labs(title = "To what extent did the information stress the positive benefits of \nadopting open science practices?", x="Condition", y="Mean ratings of gain manipulation")

```


#Mean ratings for loss manipulation check by group

Column graph:

```{r}

lossmanip <- manipcheck %>%
  filter(question == "lossmanipulation")

lossmanip %>%
    ggplot(aes(x = group, y = mean, fill = group)) +
    geom_col(width = 0.5, show.legend = FALSE) +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3, 
                  width=.2) +
  theme_classic() +
  labs(title = "To what extent did the information stress the negative consequences of \nnot adopting open science practices?", x="Condition", y="Mean ratings of loss manipulation")

```


Geom jitter plot:

 > JR the factor() isnt necessary for the clean_data df because group is already a factor
 
```{r}
glimpse(clean_data)


#clean_data %>%
 # mutate(group = factor(group, 
                       # levels = c(1, 2),
                        #labels = c("Gain", "Loss"))) 



clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = manipulation_check_lf_1, colour = group)) +
  geom_jitter(width = 0.3, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,6)) +
  theme_classic() +
  labs(title = "To what extent did the information stress the negative consequences of \nnot adopting open science practices?", x="Condition", y="Mean ratings of loss manipulation")

```



# Mean ratings for gain and loss manipulation check by group

#Facet_wrap()


```{r}

glimpse(manipcheck)


manipcheck %>%
    ggplot(aes(x = group, y = mean, fill = group)) +
    geom_col(width = 0.7, position = "dodge", show.legend = FALSE) +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    theme_classic() +
    facet_wrap(~ question) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3,
                  width=.2,
                  position=position_dodge(.9)) +
     labs(x="Condition", y="Mean ratings of information")

```
> JC. Is there a way to rename "gain" to "Gain", "loss" to "Loss", "gainmanipulation" to "Gain Manipulation", and "lossmanipulation" to "Loss Manipulation"? I tried using the rename() function but can only seem to do it for variable names. I also tried levels(manipcheck$group) <- c("gain to Gain") but it didn't work. Would it be mutating the labels? i can't work out the exact function

> JR yes you want to check what kind of data R thinks each variable is using glimpse(). It is showing both group and question as characters, rather htan factors. You can use the same kind of code you were using above to convert 1 and 2 to gain loss to change the labels of both. Dont forget to use the <- to assign the output to the df, so that it sticks around. 

clean_data <- clean_data %>%
  mutate(group = factor(group, 
                       # levels = c(1, 2),
                        #labels = c("Gain", "Loss"))) 

#Mean ratings for perception by group

Column graph:
> JR- note it might be simpler to filter straight into your ggplots code. Rather than creating a new df that is filtered, you can pipe from filter stragith into ggplot 

```{r}


per_att_int %>%
  filter(question == "perception") %>%
  ggplot(aes(x = group, y = mean, fill = group)) +
  geom_col(width = 0.5, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                size=.3, 
                width=.2) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of perception")
  
```

Geom jitter plot:

```{r}

clean_data %>%
  mutate(group = factor(group,
                        levels = c(1, 2),
                        labels = c("Gain", "Loss")))

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = perception_1, colour = group)) +
  geom_jitter(width = 0.3, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,6)) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of perception")

```


#Mean ratings for attitude by group

Column graph:
 > fix this one to use the same filter into ggplot method
 
 
```{r}

att_plot <- per_att_int %>%
  filter(question %in% c("attitude")) %>%
  group_by(group, question)

att_plot %>%
  ggplot(aes(x = group, y = mean, fill = group)) +
  geom_col(width = 0.5, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                size=.3, 
                width=.2) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of attitude")

```

Geom jitter plot:

```{r}

clean_data %>%
  mutate(group = factor(group, 
                        levels = c(1, 2),
                        labels = c("Gain", "Loss")))

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = mean_att, colour = group)) +
  geom_jitter(width = 0.3, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,6)) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of attitude")

```

#Mean ratings for intention by group

Column graph:

 > fix this one to use the same filter into ggplot method

```{r}

int_plot <- per_att_int %>%
  filter(question %in% c("intention")) %>%
  group_by(group, question)

int_plot %>%
  ggplot(aes(x = group, y = mean, fill = group)) +
  geom_col(width = 0.5, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                size=.3, 
                width=.2) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of intention")

```

Geom jitter plot:

```{r}

clean_data %>%
  mutate(group = factor(group, 
                        levels = c(1, 2),
                        labels = c("Gain", "Loss")))

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = mean_int, colour = group)) +
  geom_jitter(width = 0.3, show.legend = FALSE) +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,6)) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of intention")

```
#Mean ratings for perception, attitude, and intention by group

#Facet_wrap()

```{r}

per_att_int %>%
    ggplot(aes(x = group, y = mean, fill = group)) +
    geom_col(width = 0.7, position = "dodge", show.legend = FALSE) +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    theme_classic() +
    facet_wrap(~ question) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3,
                  width=.2,
                  position=position_dodge(.9)) +
     labs(x="Condition", y="Mean ratings")

```