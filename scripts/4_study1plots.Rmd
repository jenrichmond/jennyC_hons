---
title: "4_study1plots"
author: "Jen Richmond"
date: "13/07/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# load packages
 
```{r}
library(tidyverse)
library(here)
library(ggeasy)

```

# read data

```{r message=FALSE, warning=FALSE}
clean_data <- read_csv(here("data", "dateStudy1data_clean.csv"))
```

```{r}

summary_data <- read_csv(here("data", "summary_data.csv"))

manipcheck <- read_csv(here("data", "manipcheck.csv"))

per_att_int <- read_csv(here("data", "per_att_int.csv"))

```



Categorical variable: group
Continuous variable: perception_1, mean_att, mean_int

#Mean ratings for gain manipulation check by group

Column graph:

> in the first bit of code here, are you trying to filter for just the gain manipulation questions?? You need to assign the output of that to a new object, that you then use for your plot. otherwise the chunk below, will use the original unchanged manipcheck dataframe- I think that is why you have two sets of error bars 

```{r}

manipcheck %>%
  filter(question %in% c("gainmanipulation")) %>%
  group_by(group, question)

```


```{r}

manipcheck %>%
    ggplot(aes(x = group, y = mean)) +
    geom_col() +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3, 
                  width=.2) +
  theme_classic() +
  labs(title = "To what extent did the information stress the positive benefits of \nadopting open science practices?", x="Condition", y="Mean ratings of gain manipulation")

```

> JR: things to work out how to fix in this plot...
1. how to make the bars sit on the x axis - DONE
2. how to make bars less wide ---- can you make them skinnier, and maybe differentiate the bars by colour??
3. add more descriptive x and y axis labels - DONE
4. wrap title so it will fit - DONE
5. something is wrong with the error bars, you have two sets here- fix this up
6. 


Geom jitter plot:

> same issue here, when you pipe clean_data into your mutate, but don't assign the output to a new object, it will run the code, but not save the changes. If you want to make permanent changes to the df you need to use the assignment <- to save the changes so that they will be applied when you use the df in your plot

```{r}

clean_data <- clean_data %>%
  mutate(group = factor(group, 
                        levels = c(1, 2),
                        labels = c("gain", "loss")))

```

> JR up to here... I think you need to be a little self reflective about how happy you are with how the plots look. And if I make a suggestion (like making the bars narrower, or the jitter more constrained) it is because I think you should do it. When you tell me that you have pushed it back, i take that to mean that you are happy with it. The plot below has lots of points cut in half??


```{r}

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = manipulation_check_gf_1)) +
  geom_jitter() +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  theme_classic() +
  labs(title = "To what extent did the information stress the positive benefits of \nadopting open science practices?", x="Condition", y="Mean ratings of gain manipulation")

```

> JR: things to work out how to fix in this plot...
1. how to make the group not be 1.0, 1.5, 2.0 (ideally you want this to say gain loss)
2. how to make jitter more constrained
3. add more descriptive x and y axis labels
4. wrap title so it will fit



#Mean ratings for loss manipulation check by group

Column graph:

```{r}

manipcheck %>%
  filter(question %in% c("lossmanipulation")) %>%
  group_by(group, question)

manipcheck %>%
    ggplot(aes(x = group, y = mean)) +
    geom_col() +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3, 
                  width=.2) +
  theme_classic() +
  labs(title = "To what extent did the information stress the negative consequences of \nnot adopting open science practices?", x="Condition", y="Mean ratings of loss manipulation")

```

> JR: things to work out how to fix in this plot...
1. this one doesn't work, only gives 1 bar?? shoudl look like gain bar plot above
2. maybe it makes sense to put both gain and loss manipulation check on a single plot, can yu do that with facet_wrap()?


Geom jitter plot:

```{r}

clean_data %>%
  mutate(group = factor(group, 
                        levels = c(1, 2),
                        labels = c("gain", "loss")))

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = manipulation_check_lf_1)) +
  geom_jitter() +
  scale_y_continuous(limits = c(0,5)) +
  theme_classic() +
  labs(title = "To what extent did the information stress the negative consequences of \nnot adopting open science practices?", x="Condition", y="Mean ratings of loss manipulation")

```

> JR: things to work out how to fix in this plot...
1. how to make jitter more constrained
2. add more descriptive x and y axis labels
3. wrap title so it will fit

#Mean ratings for gain and loss manipulation check by group

#Facet_wrap()

```{r}

manipcheck %>%
    ggplot(aes(x = group, y = mean)) +
    geom_col(position = "dodge") +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    theme_classic() +
    facet_wrap(~ question) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3,
                  width=.2,
                  position=position_dodge(.9)) +
     labs(x="Type of information manipulation", y="Mean ratings of information")
                  
```


#Mean ratings for perception by group

Column graph:

```{r}
# note you shouldn't have to do this everytime, once you convert group to factor with labels in the summary dataframe, and use assignment <- to apply the change to the dataframe it will stick

per_att_int %>%
  filter(question %in% c("perception")) %>%
  group_by(group, question)

per_att_int %>%
  ggplot(aes(x = group, y = mean)) +
  geom_col() +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                size=.3, 
                width=.2) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of perception")

```

> JR: things to work out how to fix in this plot...
1. this one doesn't work, only gives 1 bar?? 
2. more descriptive x and y axis labels
3. bar sits on x axis


Geom jitter plot:

```{r}

clean_data %>%
  mutate(group = factor(group,
                        levels = c(1, 2),
                        labels = c("gain", "loss")))

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = perception_1)) +
  geom_jitter() +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of perception")

```

> JR: things to work out how to fix in this plot...
1. more constrained jitter
2. more descriptive x and y axis labels
3. more accurate title, this isn't means

#Mean ratings for attitude by group

Column graph:

```{r}

per_att_int %>%
  filter(question %in% c("attitude")) %>%
  group_by(group, question)

per_att_int %>%
  ggplot(aes(x = group, y = mean)) +
  geom_col() +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                size=.3, 
                width=.2) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of attitude")

```
> JR: things to work out how to fix in this plot...
1. this one doesn't work, only gives 1 bar?? 
2. more descriptive x and y axis labels
3. bars sits on x axis

Geom jitter plot:

```{r}

clean_data %>%
  mutate(group = factor(group, 
                        levels = c(1, 2),
                        labels = c("gain", "loss")))

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = mean_att)) +
  geom_jitter() +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of attitude")

```

#Mean ratings for intention by group

Column graph:

```{r}

per_att_int %>%
  filter(question %in% c("intention")) %>%
  group_by(group, question)

per_att_int %>%
  ggplot(aes(x = group, y = mean)) +
  geom_col() +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                size=.3, 
                width=.2) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of intention")

```

Geom jitter plot:

```{r}

clean_data %>%
  mutate(group = factor(group, 
                        levels = c(1, 2),
                        labels = c("gain", "loss")))

clean_data %>%
  group_by(group) %>%
  ggplot(aes(x = group, y = mean_int)) +
  geom_jitter() +
  scale_y_continuous(expand = c(0,0),
                     limits = c(0,5)) +
  theme_classic() +
  labs(x="Condition", y="Mean ratings of intention")

```
#Mean ratings for perception, attitude, and intention by group

#Facet_wrap()

```{r}

per_att_int %>%
    ggplot(aes(x = group, y = mean)) +
    geom_col(position = "dodge") +
    scale_y_continuous(expand = c(0,0),
                       limits = c(0,5)) +
    theme_classic() +
    facet_wrap(~ question) +
    geom_errorbar(aes(ymin=mean-StdErr, ymax=mean+StdErr),
                  size=.3,
                  width=.2,
                  position=position_dodge(.9)) +
     labs(x="Condition", y="Mean ratings")
                  
```